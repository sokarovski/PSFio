{"version":3,"sources":["PS.js","PS/PSFio.js","PS/PSFio/Builders.js","PS/PSFio/FileHelper.js","PS/PSFio/PathHelper.js","PS/PSFio/Renderers.js","PS/PSFio/Widgets.js","PS/PSFio/Builders/Inline.js","PS/PSFio/Builders/Popup.js","PS/PSFio/Renderers/Grid.js","PS/PSFio/Renderers/Table.js","PS/PSFio/Widgets/Browse.jQuery.js","PS/PSFio/Widgets/FileBrowser.jQueryHook.js","PS/PSFio/Widgets/Image.jQueryHook.js","PS/PSFio/Widgets/Image.js"],"names":["PS","PSFio","_class","opts","_classCallCheck","this","inline","buildWith","builder","allowMultipleUploads","multiple","loadedDir","currentFolder","fileList","callback","destroyOnPick","parseConnector","connector","build","buildElements","findDefaultRenderer","renderer","refresh","prototype","preferedConnector","headConnector","$","attr","substr","setCallback","preferedRenderer","sessionRenderer","setRenderer","localStorage","getItem","Renderers","Grid","clear","pane","empty","prepare","renderersGroup","find","removeClass","getIdentifier","addClass","render","Builders","Inline","Popup","buildNewFolderButton","buildUploadButton","buildRenderersButtons","buttons","append","document","createTextNode","uploadFile","jQuery","buildUpload","inElement","upload","on","handleUpload","bind","holder","length","css","formData","getFormDataFromUpload","uploadFiles","input","form","folder","val","FormData","newFolder","makeNewFolder","newFolderName","prompt","renderers","x","getIcon","rendererButton","pickRenderer","appendTo","setItem","goToFolder","files","path","request","onFilesSuccess","onFilesError","parseFiles","rename","item","newName","file","onRenameSuccess","onRenameError","deleteItem","onDeleteItemSuccess","onDeleteItemError","name","folderName","onNewFolderSuccess","onNewFolderError","ajax","type","data","dataType","success","onUploadFilesSuccess","error","onUploadFilesError","processData","contentType","action","structure","clearPane","upElement","getUP","parentFolder","PathHelper","getParentFolder","appendElement","i","folders","folderElement","getFolder","consumeFolderElement","fileElement","getFile","consumeFileElement","armFileElement","isBack","armFolderElement","element","armMutual","pickFile","goToItem","itemElement","deleteItemConfirm","renameItemPrompt","destroy","hide","isConfirmed","confirm","reset","show","clean","getShared","sharedInstance","getAssetPath","root","FileHelper","getFaIconForFile","extension","getFileParts","toLowerCase","parts","split","pop","join","fileName","fileParts","Widgets","appendButtonsTo","console","log","remove","closeOnEscape","shouldShow","html","modal","keyboard","getMutual","icon","image","text","getCol","btnGroup","inner","imageSizer","list","e","preventDefault","Table","getRow","size","dateCreated","dateModified","actions","table","thead","tbody","thRow","createHeadColumn","row","ready","browsers","eq","fn","methodOrOptions","me","firstMe","instance","Array","slice","call","arguments","Image","inputs","displayFile","wrapper","insertAfter","formGroup","noImage","buttonGroup","browse","detach","fio","onPick"],"mappings":"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","file":"psfio.min.js","sourcesContent":["if (!PS)\n    var PS = {}","PS.PSFio = class {\n\n    /**=============================================================================================\n     * Constructing\n     =============================================================================================*/    \n\n    constructor(opts) {\n        opts = opts || {};\n        this.inline = !!opts.inline;\n        this.buildWith = opts.builder;\n        this.allowMultipleUploads = opts.multiple !== false;\n        this.loadedDir = '';\n        this.currentFolder = '';\n        this.fileList = null;\n        this.callback = opts.callback;\n        this.destroyOnPick = opts.destroyOnPick;\n\n        this.parseConnector(opts.connector);\n        this.build(opts);\n        this.buildElements();\n        this.findDefaultRenderer(opts.renderer);\n        this.refresh();\n    }\n\n    parseConnector(preferedConnector) {\n        var headConnector;\n\n        if (preferedConnector) {\n            this.connector = preferedConnector;\n        } else if (headConnector = $('meta[name=\"psfio-connector\"]').attr('content')) {\n            this.connector = headConnector;\n        } else {\n            this.connector = '/psfio';\n        }\n\n        if (this.connector && this.connector.substr(-1) != '/')\n            this.connector += '/';\n    }\n\n    setCallback(callback) {\n        this.callback = callback;\n    }\n\n    findDefaultRenderer(preferedRenderer) {\n        var sessionRenderer;\n\n        if (preferedRenderer) \n            this.setRenderer(preferedRenderer);\n        else if (sessionRenderer = localStorage.getItem('psfio-renderer')) \n            this.setRenderer(PS.PSFio.Renderers[sessionRenderer]);\n        else \n            this.setRenderer(PS.PSFio.Renderers.Grid);\n    }\n\n    setRenderer(renderer) {\n        if (this.renderer)\n            this.renderer.clear(this.fileList);\n\n        this.builder.pane.empty();\n        this.renderer = renderer; \n        this.fileList = this.renderer.prepare(this.builder.pane);\n\n        this.renderersGroup.find('.active').removeClass('active');\n        this.renderersGroup.find('*[data-id='+renderer.getIdentifier()+']').addClass('active');\n\n        this.render();\n    }\n\n    build(opts) {\n        var builder = this.buildWith || this.inline ? \n                    PS.PSFio.Builders.Inline:\n                    PS.PSFio.Builders.Popup;\n\n        this.builder = new builder(opts)\n    }\n\n    /**=============================================================================================\n     * Navbar\n     =============================================================================================*/\n\n    buildElements() {\n        this.buildNewFolderButton();\n        this.buildUploadButton();\n        this.buildRenderersButtons();\n\n    }\n\n    buildUploadButton() {\n        this.builder.buttons.append(document.createTextNode(' '));\n        var uploadFile = jQuery('<div class=\"btn btn-xs btn-default\"><i class=\"fa fa-upload\"></i> Upload File</div>');\n        this.builder.buttons.append(uploadFile);\n        this.buildUpload(uploadFile);\n    }\n\n    buildUpload(inElement) {\n        var upload = jQuery('<input type=\"file\" name=\"uploads[]\" />');\n        upload.on('change', this.handleUpload.bind(this, inElement));\n        if (this.allowMultipleUploads)\n            upload.attr('multiple', '');\n        \n        var holder = inElement.find('.psfio-uploadholder');\n        if (holder.length == 0) {\n            holder = jQuery('<div class=\"psfio-uploadholder\"></div>');\n            inElement.css('position', 'relative');\n            inElement.append(holder);\n        }\n\n        holder.empty().append(upload);\n    }\n\n    handleUpload(inElement) {\n        var formData = this.getFormDataFromUpload(inElement);\n        this.uploadFiles(formData);\n        this.buildUpload(inElement);\n    }\n\n    getFormDataFromUpload(input) {\n        var form = jQuery('<form></form>');\n        var folder = jQuery('<input type=\"text\" name=\"folder\" />').val(this.loadedDir);\n        form.append(input.find('input[type=file]')).append(folder);\n        return new FormData(form[0]);\n    }\n\n    buildNewFolderButton() {\n        var newFolder = jQuery('<button class=\"btn btn-xs btn-default\"><i class=\"fa fa-plus\"></i>  New Folder</button>');\n        newFolder.on('click', this.makeNewFolder.bind(this));\n        this.builder.buttons.append(newFolder);\n    }\n\n    makeNewFolder() {\n        var newFolderName = prompt('New folder name:');\n        if (newFolderName)\n            this.newFolder(newFolderName);\n        \n    }\n\n    buildRenderersButtons() {\n        var renderersGroup = jQuery('<div class=\"btn-group\"></div>');\n        this.renderersGroup = renderersGroup;\n\n        var table = jQuery('<btn class=\"btn btn-xs btn-default\"><i class=\"fa fa-th-list\"></i></btn>');\n        var renderers = 0;\n        for (var x in PS.PSFio.Renderers) {\n            var renderer = PS.PSFio.Renderers[x];\n            if (renderer.getIcon && renderer.getIdentifier) {\n                var rendererButton = jQuery('<btn class=\"btn btn-xs btn-default\" ></btn>');\n                rendererButton.attr('data-id', renderer.getIdentifier());\n                rendererButton.on('click', this.pickRenderer.bind(this, renderer));\n                jQuery('<i class=\"fa fa-th\"></i>').addClass(renderer.getIcon()).appendTo(rendererButton);\n                renderersGroup.append(rendererButton);\n                renderers++;\n            }\n        }\n\n        if (renderers > 0){\n            this.builder.buttons.append(document.createTextNode(' '));\n            this.builder.buttons.append(renderersGroup);\n        }\n    }\n\n    pickRenderer(renderer) {\n        localStorage.setItem('psfio-renderer', renderer.getIdentifier()); \n        this.setRenderer(renderer);\n    }\n\n    /**=============================================================================================\n     * API\n     =============================================================================================*/\n\n    goToFolder(folder) {\n        this.loadedDir = folder;\n        this.refresh();\n    }\n\n    refresh() {\n        this.files(this.loadedDir);\n    }\n\n    files(path) {\n        this.request('files', {}, this.onFilesSuccess.bind(this), this.onFilesError.bind(this));\n    }\n\n    onFilesSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onFilesError() {}\n\n    rename(item, newName) {\n        this.request('rename', {file: item, newName: newName}, this.onRenameSuccess.bind(this), this.onRenameError.bind(this));\n    }\n\n    onRenameSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onRenameError() {}\n\n    deleteItem(item) {\n        this.request('delete', {files: item}, this.onDeleteItemSuccess.bind(this), this.onDeleteItemError.bind(this));\n    }\n\n    onDeleteItemSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onDeleteItemError() {}\n\n    newFolder(name) {\n        this.request('newFolder', {folderName: name}, this.onNewFolderSuccess.bind(this), this.onNewFolderError.bind(this));\n    }\n\n    onNewFolderSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onNewFolderError() {}\n\n    uploadFiles(formData) {\n        jQuery.ajax(this.connector+'upload', {\n            type: 'POST',\n            data: formData,\n            dataType: 'json',\n            success: this.onUploadFilesSuccess.bind(this), \n            error: this.onUploadFilesError.bind(this),\n            processData: false, \n            contentType: false\n        });\n    }\n\n    onUploadFilesSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onUploadFilesError() {}\n\n    request(action, data, success, error) {\n        data = data || {};\n        data.folder = this.loadedDir;\n\n        jQuery.ajax(this.connector+action, {\n            type: 'GET',\n            data: data,\n            dataType: 'json',\n            success: success, \n            error: error\n        });\n    }\n\n    /**=============================================================================================\n     * Binding\n     =============================================================================================*/\n\n    parseFiles(files) {\n        this.structure = files;\n        this.render();\n    }\n\n    render() {\n        if (!this.structure)\n            return;\n\n        this.clearPane();\n        if (this.loadedDir != '') {\n            var upElement = this.renderer.getUP('UP');\n            var parentFolder = PS.PSFio.PathHelper.getParentFolder(this.loadedDir);\n            upElement.on('dblclick', this.goToFolder.bind(this, parentFolder));\n            this.appendElement(upElement);\n        }\n        \n        //List Folders\n        for (var i=0; i<this.structure.folders.length; i++) {\n            var folder = this.structure.folders[i];\n            var folderElement = this.renderer.getFolder(folder);\n            this.consumeFolderElement(folderElement, folder);\n        }\n\n        //List Files\n        for (var i=0; i<this.structure.files.length; i++) {\n            var file = this.structure.files[i];\n            var fileElement = this.renderer.getFile(file);\n            this.consumeFileElement(fileElement, file);\n        }\n    }\n\n    consumeFileElement(fileElement, file) {\n        this.appendElement(fileElement);\n        this.armFileElement(fileElement, file);\n    }\n\n    consumeFolderElement(folderElement, folder, isBack) {\n        this.appendElement(folderElement);\n        this.armFolderElement(folderElement, folder);\n    }\n\n    appendElement(element) {\n        this.fileList.append(element);\n    }\n\n    clearPane() {\n        this.renderer.clear(this.fileList);\n    }\n\n    armFileElement(fileElement, file) {\n        this.armMutual(fileElement, file);\n        fileElement.on('dblclick', this.pickFile.bind(this, file));\n    }\n\n    armFolderElement(folderElement, folder) {\n        this.armMutual(folderElement, folder);\n        folderElement.on('dblclick', this.goToItem.bind(this, folder));\n    }\n\n    armMutual(itemElement, item) {\n        itemElement.find('.psfio-remove').on('click', this.deleteItemConfirm.bind(this, item));\n        itemElement.find('.psfio-rename').on('click', this.renameItemPrompt.bind(this, item));\n    }\n\n    pickFile(file) {\n        //@TODO should be sanitized when sanitization function is created and this condition should be removed this.loadedDir ? : ...\n        if (this.callback)\n            this.callback([this.loadedDir ? this.loadedDir+'/'+file : file]);\n\n        if (this.destroyOnPick)\n            this.destroy();\n        else if (!this.inline)\n            this.hide();\n    }\n\n    goToItem(item) {\n        this.goToFolder(item);\n    }\n\n    renameItemPrompt(item) {\n        var newName = prompt('Rename file', item);\n        if (newName)\n            this.rename(item, newName)\n    }\n\n    deleteItemConfirm(item) {\n        var isConfirmed = confirm('Are you sure you want to delete this file');\n        if (isConfirmed)\n            this.deleteItem([item]);\n    }\n\n    /**=============================================================================================\n     * Binding\n     =============================================================================================*/\n\n    reset() {\n        this.clearPane();\n        this.goToFolder('');\n    }\n\n    //Facaded for easier access\n    hide() {\n        if (this.builder)\n            this.builder.hide();\n    }\n\n    //Facaded for easier access\n    show() {\n        if (this.builder)\n            this.builder.show();\n    }\n\n    destroy() {\n        this.hide();\n\n        this.builder.clean();\n        this.builder = null;\n\n        this.renderer.clean();\n        this.renderer = null;\n\n        this.structure = null;\n    }\n\n    static getShared() {\n        if (!this.sharedInstance)\n            this.sharedInstance = new this({show: false});\n\n        return this.sharedInstance;\n    }\n\n    static getAssetPath(path) {\n        if (!this.root) {\n            var root = $('meta[name=\"psfio-root\"]').attr('content');\n            this.root = root ? root : '/files';\n        }\n\n        //@TODO Should be sanitized upon concatenation\n        return this.root + '/' + path;\n    }\n}","PS.PSFio.Builders = {};","PS.PSFio.FileHelper = {\n    getFaIconForFile: function(file) {\n        var extension = PS.PSFio.PathHelper.getFileParts(file).extension;\n        extension = extension.toLowerCase();\n        switch (extension) {\n            case 'jpg': \n            case 'png': \n            case 'gif':\n            case 'jpeg': \n                return true;\n            case 'xls':\n            case 'xlsx':\n                return 'fa-file-excel-o';\n            case 'pdf':\n                return 'fa-file-pdf-o';\n            case 'doc':\n            case 'docx':\n            case 'rtf':\n            case 'txt':\n                return 'fa-file-word-o';\n            case 'zip':\n            case 'bz':\n            case 'gz':\n            case 'tar':\n                return 'fa-file-zip-o';\n            case 'mpeg4':\n            case 'mov':\n            case 'mp4':\n                return 'fa-file-movie-o';\n            case 'mp3':\n            case 'aiff':\n                return 'fa-file-audio-o';\n            case 'html':\n            case 'css':\n            case 'less':\n            case 'sass':\n            case 'js':\n            case 'php':\n                return 'fa-file-code-o';\n            default: \n                return 'fa-file-o';\n        }\n    }\n}","PS.PSFio.PathHelper = {\n    \n    getParentFolder: function(path) {\n        if (!path)\n            return '';\n\n        if (path.substr(-1) == '/')\n            path = path.substr(0, path.length-1);\n\n        var parts = path.split('/');\n        parts.pop();\n        return parts.join('/');\n    },\n\n    getFileParts: function(path) {\n        var extension = '';\n        var name = '';\n\n        if (path) {\n            var parts = path.split('/');\n            var fileName = parts.pop();\n\n            var fileParts = fileName.split('.');\n            extension = fileParts.pop();\n            name = fileParts.join('.');\n        }\n\n        return {\n            extension: extension, \n            name: name\n        }\n    }\n\n}","PS.PSFio.Renderers = {};","PS.PSFio.Widgets = {};","PS.PSFio.Builders.Inline = class {\n    \n    constructor(opts) {\n        opts = opts || {};\n        this.buttons = opts.appendButtonsTo;\n        this.appendTo = jQuery(opts.appendTo);\n        console.log(opts);\n        this.build();\n    }\n\n    build() {\n        console.log(this.appendTo);\n        this.element = jQuery('<div class=\"psfio psfio-inline\"></div>').appendTo(this.appendTo);\n        \n        if (!this.buttons) \n            this.buttons = jQuery('<div class=\"psfio-buttons\"></div>').appendTo(this.element);\n\n        this.pane = jQuery('<div class=\"psfio-pane\"></div>').appendTo(this.element);\n    }\n\n    clean() {\n        this.element.remove();\n    }\n\n}","PS.PSFio.Builders.Popup = class {\n    \n    constructor(opts) {\n        opts = opts || {};\n        this.appendTo = opts.appendTo ? jQuery(opts.appendTo) : 'body';\n        this.closeOnEscape = opts.closeOnEscape !== false;\n        this.shouldShow = opts.show !== false;\n        this.build(opts);\n    }\n    \n    build() {\n        \n        var html = \n        '<div class=\"modal fade psfio\" tabindex=\"-1\" role=\"dialog\">' +\n            '<div class=\"modal-dialog modal-lg\" role=\"document\">' +\n                '<div class=\"modal-content\">' +\n                    '<div class=\"modal-header\">' +\n                        '<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\n                        '<div class=\"psfio-buttons\"></div>' +\n                    '</div>' +\n                    '<div class=\"modal-body\"><div class=\"psfio-pane\"></div></div>' +\n                    // '<div class=\"modal-footer\"></div>' +\n                '</div>' + \n            '</div>' +\n        '</div>';\n        var modal =  jQuery(html);\n\n        modal.find('.modal-dialog').css('height', '85%');\n        modal.find('.modal-content').css('height', '100%');\n\n        modal.appendTo(this.appendTo);\n        modal.modal({\n            keyboard: this.closeOnEscape,\n            show: this.shouldShow\n        });\n        this.modal = modal;\n        this.buttons = modal.find('.psfio-buttons');\n        this.pane = modal.find('.psfio-pane');\n    }\n\n    clean() {\n        this.modal.remove();\n        this.buttons = null;\n        this.pane = null;\n        this.appendTo = null;\n    }\n\n    show() {\n        this.modal.modal('show');\n    }\n\n    hide() {\n        this.modal.modal('hide')\n    }\n\n}","PS.PSFio.Renderers.Grid = {\n    getFile: function(file) {\n        var parts = this.getMutual(file);\n        parts.element.addClass('ps-fio-grid-item-folder');\n        var icon = PS.PSFio.FileHelper.getFaIconForFile(file);\n        if (icon === true)\n            parts.image.css('background-image', 'url(\"'+PS.PSFio.getAssetPath(file)+'\")');\n        else \n            jQuery('<i class=\"fa\"></i>').addClass(icon).appendTo(parts.image);\n        return parts.element;\n    },\n\n    getFolder: function(folder) {\n        var parts = this.getMutual(folder);\n        parts.element.addClass('ps-fio-grid-item-folder');\n        parts.image.append('<i class=\"fa fa-folder\"></i>');\n        return parts.element;\n    },\n\n    getUP: function(text) {\n        var parts = this.getCol();\n        parts.name.text(text);\n        parts.element.addClass('ps-fio-grid-item-back');\n        parts.image.append('<i class=\"fa fa-level-up\"></i>');\n        return parts.element;\n    },\n\n    getMutual: function(item) {\n        var parts = this.getCol();\n        var remove = jQuery('<a href=\"javascript:;\" class=\"btn btn-xs btn-danger psfio-remove\"><i class=\"fa fa-trash\"></i></a>');\n        var rename = jQuery('<a href=\"javascript:;\" class=\"btn btn-xs btn-default psfio-rename\"><i class=\"fa fa-edit\"></i></a>');\n        parts.btnGroup.append(rename).append(remove);\n        parts.name.text(item);\n        return parts;\n    },\n\n    getCol: function() {\n        var element = jQuery('<div class=\"psfio-grid-item\"></div>');\n        var inner = jQuery('<div class=\"psfio-grid-item-inner\"></div>');\n        var name = jQuery('<p class=\"psfio-name\"></p>');\n        var imageSizer = jQuery('<div class=\"psfio-grid-item-image-sizer\"></div>');\n        var image = jQuery('<div class=\"psfio-grid-item-image\"></div>');\n        var btnGroup = jQuery('<div class=\"btn-group\"></div>');\n\n        element.append(inner);\n        inner.append(imageSizer).append(name);\n        imageSizer.append(image);\n        inner.append(btnGroup);\n\n        return {\n            element: element,\n            name: name,\n            inner: inner,\n            image: image,\n            btnGroup: btnGroup\n        }\n    },\n\n    prepare: function(pane) {\n        var list = jQuery('<div class=\"psfio-grid-list\"></div>');\n        pane.append(list);\n        list.on('mousedown', function(e) {e.preventDefault()});\n        return list;\n    },\n\n    clear: function(fileList) {\n        fileList.empty();\n    },\n\n    getIcon: function() {\n        return 'fa-th';\n    },\n\n    getIdentifier: function() {\n        return 'Grid';\n    }\n}","PS.PSFio.Renderers.Table = {\n    getFile: function(file) {\n        var parts = this.getMutual(file);\n        parts.element.addClass('ps-fio-table-item-folder');\n        var icon = PS.PSFio.FileHelper.getFaIconForFile(file);\n        if (icon === true)\n            jQuery('<img class=\"img-responsive\" />').attr('src', PS.PSFio.getAssetPath(file)).appendTo(parts.icon);\n        else \n            jQuery('<i class=\"fa\"></i>').addClass(icon).appendTo(parts.icon);\n        return parts.element;\n    },\n\n    getFolder: function(folder) {\n        var parts = this.getMutual(folder);\n        parts.element.addClass('ps-fio-table-item-folder');\n        parts.icon.append('<i class=\"fa fa-folder\"></i>');\n        return parts.element;\n    },\n\n    getUP: function(text) {\n        var parts = this.getRow();\n        parts.name.text(text);\n        parts.element.addClass('active ps-fio-table-item-back');\n        parts.icon.append('<i class=\"fa fa-level-up\"></i>');\n        return parts.element;\n    },\n\n    getMutual: function(item) {\n        var parts = this.getRow();\n        var remove = jQuery('<a href=\"javascript:;\" class=\"btn btn-xs btn-danger psfio-remove\"><i class=\"fa fa-trash\"></i></a>');\n        var rename = jQuery('<a href=\"javascript:;\" class=\"btn btn-xs btn-default psfio-rename\"><i class=\"fa fa-edit\"></i></a>');\n        parts.btnGroup.append(rename).append(remove);\n        parts.name.text(item);\n        return parts;\n    },\n\n    getRow: function() {\n        var element = jQuery('<tr></tr>');\n        var btnGroup = jQuery('<div class=\"btn-group\"></div>');\n\n        return {\n            element: element,\n            btnGroup: btnGroup,\n            icon: jQuery('<td></td>').appendTo(element),\n            name: jQuery('<td class=\"col-xs-6\"></td>').appendTo(element),\n            size: jQuery('<td class=\"col-xs-1\"></td>').appendTo(element),\n            dateCreated: jQuery('<td class=\"col-xs-2\"></td>').appendTo(element),\n            dateModified: jQuery('<td class=\"col-xs-2\"></td>').appendTo(element),\n            actions: jQuery('<td class=\"col-xs-1\"></td>').appendTo(element).append(btnGroup)\n        }\n    },\n\n    prepare: function(pane) {\n        var table = jQuery('<table class=\"table table-hover table-condensed\"></table>');\n        var thead = jQuery('<thead></thead>');\n        var tbody = jQuery('<tbody></tbody>');\n        var thRow = jQuery('<tr></tr>');\n\n        this.createHeadColumn(thRow, '');\n        this.createHeadColumn(thRow, 'Name');\n        this.createHeadColumn(thRow, 'Size');\n        this.createHeadColumn(thRow, 'Date created');\n        this.createHeadColumn(thRow, 'Date updated');\n        this.createHeadColumn(thRow, 'Actions');\n\n        thead.append(thRow);\n        table.append(thead).append(tbody);\n        \n        pane.append(table);\n        table.on('mousedown', function(e) {e.preventDefault()});\n        return tbody;\n    },\n\n    createHeadColumn: function(row, name) {\n        jQuery('<th></th>').text(name).appendTo(row);\n    },\n\n    clear: function(fileList) {\n        fileList.empty();\n    },\n\n    getIcon: function() {\n        return 'fa-th-list';\n    },\n\n    getIdentifier: function() {\n        return 'Table';\n    }\n}","$(document).ready(function() {\n    var browsers = jQuery('*[data-psfio=\"browse\"]');\n    for (var i=0; i<browsers.length; i++) {\n        browsers.eq(i).on('click', function() {\n            PS.PSFio.getShared().show();\n        });\n    }\n});","(function($, name) {\n\n    $.fn[name] = function( methodOrOptions ) {\n\n        var me = $(this);\n\n        if (!me.length) \n            return me;\n\n        var firstMe = $(this).eq(0);\n        \n        var instance = firstMe.data(name);\n            \n        // CASE: call method     \n        if (instance && instance[ methodOrOptions ] && \n            typeof( instance[ methodOrOptions ] ) == 'function' ) {\n            \n            return instance[ methodOrOptions ]( Array.prototype.slice.call( arguments, 1 ) ); \n                \n                \n        // CASE: set options or initialize\n        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {\n\n            methodOrOptions = methodOrOptions || {};\n            methodOrOptions.inline = true;\n            methodOrOptions.appendTo = firstMe;\n            instance = new PS.PSFio( methodOrOptions );    // ok to overwrite if this is a re-init\n            firstMe.data(name, instance);\n            return me;\n        \n        // CASE: method called before init\n        } else if ( !instance ) {\n            $.error( 'Instance not created yet: ' + methodOrOptions );\n        \n        // CASE: invalid method\n        } else {\n            $.error( 'Method ' +  methodOrOptions + ' does not exist.' );\n        }\n    };\n\n    $(document).ready(function() {\n        var browsers = jQuery('*[data-psfio=\"file-browser\"]');\n        for (var i=0; i<browsers.length; i++)\n            browsers.eq(i)[name]();\n    });\n\n})(jQuery, 'PSFioFileBrowser');","(function($, name) {\n\n    $.fn[name] = function( methodOrOptions ) {\n        var me = $(this);\n        if (!me.length) \n            return me;\n\n        var firstMe = me.eq(0);\n        \n        var instance = firstMe.data(name);\n            \n        // CASE: call method     \n        if (instance && instance[ methodOrOptions ] && \n            typeof( instance[ methodOrOptions ] ) == 'function' ) {\n            \n            return instance[ methodOrOptions ]( Array.prototype.slice.call( arguments, 1 ) ); \n                \n                \n        // CASE: set options or initialize\n        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {\n\n            instance = new PS.PSFio.Widgets.Image( firstMe, methodOrOptions );    // ok to overwrite if this is a re-init\n            firstMe.data(name, instance);\n            return me;\n        \n        // CASE: method called before init\n        } else if ( !instance ) {\n            $.error( 'Instance not created yet: ' + methodOrOptions );\n        \n        // CASE: invalid method\n        } else {\n            $.error( 'Method ' +  methodOrOptions + ' does not exist.' );\n        }\n    };\n\n    $(document).ready(function() {\n        var inputs = $('input[data-psfio=\"image\"]');\n        for (var i=0; i<inputs.length; i++)\n            inputs.eq(i)[name]();\n    });\n\n})(jQuery, 'PSFioImage');","PS.PSFio.Widgets.Image = class {\n    \n    constructor(file, opts) {\n        this.input = file;\n        this.build(file);\n        this.displayFile(file.val());\n    }\n\n    build(file) {\n        var wrapper = jQuery('<div class=\"psfio-image-widget\"></div>').insertAfter(file);\n        var formGroup = jQuery('<div class=\"form-group\"></div>').appendTo(wrapper);\n        this.noImage = jQuery('<div>No image selected</div>').appendTo(formGroup);\n        this.image = jQuery('<img class=\"img-responsive\" />').appendTo(formGroup);\n\n        var buttonGroup = jQuery('<div class=\"btn-group\">').appendTo(wrapper);\n        var browse = jQuery('<button type=\"button\" class=\"btn btn-xs btn-default\"><i class=\"fa fa-folder\"></i> Browse</button>').appendTo(buttonGroup);\n        var clear = jQuery('<button type=\"button\" class=\"btn btn-xs btn-danger\"><i class=\"fa fa-remove\"></i> Remove</button>').appendTo(buttonGroup);\n\n        browse.on('click', this.browse.bind(this));\n        clear.on('click', this.clear.bind(this));\n        file.detach().appendTo(wrapper);\n    }\n\n    browse() {\n        var fio = PS.PSFio.getShared();\n        fio.setCallback(this.onPick.bind(this));\n        fio.show();\n    }\n\n    onPick(files) {\n        if (files.length > 0)\n            this.displayFile(files[0]);\n        \n    }\n\n    displayFile(file) {\n        if (file == '')\n            this.clear();\n        else {\n            this.input.val(file);\n            this.image.show().attr('src', PS.PSFio.getAssetPath(file));\n            this.noImage.hide();\n        }\n        \n    }\n\n    clear() {\n        this.input.val('');\n        this.image.hide();\n        this.noImage.show();\n    }\n\n}"]}