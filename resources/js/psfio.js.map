{"version":3,"sources":["PS.js","PS/PSFio.js","PS/PSFio/Builders.js","PS/PSFio/FileHelper.js","PS/PSFio/PathHelper.js","PS/PSFio/Renderers.js","PS/PSFio/Widgets.js","PS/PSFio/Builders/Inline.js","PS/PSFio/Builders/Popup.js","PS/PSFio/Renderers/Grid.js","PS/PSFio/Renderers/Table.js","PS/PSFio/Widgets/Browse.jQuery.js","PS/PSFio/Widgets/FileBrowser.jQueryHook.js","PS/PSFio/Widgets/Image.jQueryHook.js","PS/PSFio/Widgets/Image.js"],"names":["PS","PSFio","opts","inline","buildWith","builder","allowMultipleUploads","multiple","loadedDir","currentFolder","fileList","callback","destroyOnPick","parseConnector","connector","build","buildElements","findDefaultRenderer","renderer","refresh","preferedConnector","headConnector","$","attr","substr","setCallback","preferedRenderer","sessionRenderer","setRenderer","localStorage","getItem","Renderers","Grid","clear","pane","empty","prepare","renderersGroup","find","removeClass","getIdentifier","addClass","render","Builders","Inline","Popup","buildNewFolderButton","buildUploadButton","buildRenderersButtons","buttons","append","document","createTextNode","uploadFile","jQuery","buildUpload","inElement","upload","on","handleUpload","bind","holder","length","css","formData","getFormDataFromUpload","uploadFiles","input","form","folder","val","FormData","newFolder","makeNewFolder","newFolderName","prompt","table","renderers","x","getIcon","rendererButton","pickRenderer","appendTo","setItem","goToFolder","files","path","request","onFilesSuccess","onFilesError","parseFiles","rename","item","newName","file","onRenameSuccess","onRenameError","deleteItem","onDeleteItemSuccess","onDeleteItemError","name","folderName","onNewFolderSuccess","onNewFolderError","ajax","type","data","dataType","success","onUploadFilesSuccess","error","onUploadFilesError","processData","contentType","action","structure","clearPane","upElement","getUP","parentFolder","PathHelper","getParentFolder","appendElement","i","folders","folderElement","getFolder","consumeFolderElement","fileElement","getFile","consumeFileElement","armFileElement","isBack","armFolderElement","element","armMutual","pickFile","goToItem","itemElement","deleteItemConfirm","renameItemPrompt","destroy","hide","isConfirmed","confirm","reset","show","clean","getShared","sharedInstance","getAssetPath","root","FileHelper","getFaIconForFile","extension","getFileParts","toLowerCase","parts","split","pop","join","fileName","fileParts","Widgets","appendButtonsTo","console","log","remove","closeOnEscape","shouldShow","html","modal","keyboard","getMutual","icon","image","text","getCol","btnGroup","inner","imageSizer","list","e","preventDefault","Table","getRow","size","dateCreated","dateModified","actions","thead","tbody","thRow","createHeadColumn","row","ready","browsers","eq","fn","methodOrOptions","me","firstMe","instance","Array","prototype","slice","call","arguments","Image","inputs","displayFile","wrapper","insertAfter","formGroup","noImage","buttonGroup","browse","detach","fio","onPick"],"mappings":"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","file":"psfio.js","sourcesContent":["if (!PS)\n    var PS = {}","PS.PSFio = class {\n\n    /**=============================================================================================\n     * Constructing\n     =============================================================================================*/    \n\n    constructor(opts) {\n        opts = opts || {};\n        this.inline = !!opts.inline;\n        this.buildWith = opts.builder;\n        this.allowMultipleUploads = opts.multiple !== false;\n        this.loadedDir = '';\n        this.currentFolder = '';\n        this.fileList = null;\n        this.callback = opts.callback;\n        this.destroyOnPick = opts.destroyOnPick;\n\n        this.parseConnector(opts.connector);\n        this.build(opts);\n        this.buildElements();\n        this.findDefaultRenderer(opts.renderer);\n        this.refresh();\n    }\n\n    parseConnector(preferedConnector) {\n        var headConnector;\n\n        if (preferedConnector) {\n            this.connector = preferedConnector;\n        } else if (headConnector = $('meta[name=\"psfio-connector\"]').attr('content')) {\n            this.connector = headConnector;\n        } else {\n            this.connector = '/psfio';\n        }\n\n        if (this.connector && this.connector.substr(-1) != '/')\n            this.connector += '/';\n    }\n\n    setCallback(callback) {\n        this.callback = callback;\n    }\n\n    findDefaultRenderer(preferedRenderer) {\n        var sessionRenderer;\n\n        if (preferedRenderer) \n            this.setRenderer(preferedRenderer);\n        else if (sessionRenderer = localStorage.getItem('psfio-renderer')) \n            this.setRenderer(PS.PSFio.Renderers[sessionRenderer]);\n        else \n            this.setRenderer(PS.PSFio.Renderers.Grid);\n    }\n\n    setRenderer(renderer) {\n        if (this.renderer)\n            this.renderer.clear(this.fileList);\n\n        this.builder.pane.empty();\n        this.renderer = renderer; \n        this.fileList = this.renderer.prepare(this.builder.pane);\n\n        this.renderersGroup.find('.active').removeClass('active');\n        this.renderersGroup.find('*[data-id='+renderer.getIdentifier()+']').addClass('active');\n\n        this.render();\n    }\n\n    build(opts) {\n        var builder = this.buildWith || this.inline ? \n                    PS.PSFio.Builders.Inline:\n                    PS.PSFio.Builders.Popup;\n\n        this.builder = new builder(opts)\n    }\n\n    /**=============================================================================================\n     * Navbar\n     =============================================================================================*/\n\n    buildElements() {\n        this.buildNewFolderButton();\n        this.buildUploadButton();\n        this.buildRenderersButtons();\n\n    }\n\n    buildUploadButton() {\n        this.builder.buttons.append(document.createTextNode(' '));\n        var uploadFile = jQuery('<div class=\"btn btn-xs btn-default\"><i class=\"fa fa-upload\"></i> Upload File</div>');\n        this.builder.buttons.append(uploadFile);\n        this.buildUpload(uploadFile);\n    }\n\n    buildUpload(inElement) {\n        var upload = jQuery('<input type=\"file\" name=\"uploads[]\" />');\n        upload.on('change', this.handleUpload.bind(this, inElement));\n        if (this.allowMultipleUploads)\n            upload.attr('multiple', '');\n        \n        var holder = inElement.find('.psfio-uploadholder');\n        if (holder.length == 0) {\n            holder = jQuery('<div class=\"psfio-uploadholder\"></div>');\n            inElement.css('position', 'relative');\n            inElement.append(holder);\n        }\n\n        holder.empty().append(upload);\n    }\n\n    handleUpload(inElement) {\n        var formData = this.getFormDataFromUpload(inElement);\n        this.uploadFiles(formData);\n        this.buildUpload(inElement);\n    }\n\n    getFormDataFromUpload(input) {\n        var form = jQuery('<form></form>');\n        var folder = jQuery('<input type=\"text\" name=\"folder\" />').val(this.loadedDir);\n        form.append(input.find('input[type=file]')).append(folder);\n        return new FormData(form[0]);\n    }\n\n    buildNewFolderButton() {\n        var newFolder = jQuery('<button class=\"btn btn-xs btn-default\"><i class=\"fa fa-plus\"></i>  New Folder</button>');\n        newFolder.on('click', this.makeNewFolder.bind(this));\n        this.builder.buttons.append(newFolder);\n    }\n\n    makeNewFolder() {\n        var newFolderName = prompt('New folder name:');\n        if (newFolderName)\n            this.newFolder(newFolderName);\n        \n    }\n\n    buildRenderersButtons() {\n        var renderersGroup = jQuery('<div class=\"btn-group\"></div>');\n        this.renderersGroup = renderersGroup;\n\n        var table = jQuery('<btn class=\"btn btn-xs btn-default\"><i class=\"fa fa-th-list\"></i></btn>');\n        var renderers = 0;\n        for (var x in PS.PSFio.Renderers) {\n            var renderer = PS.PSFio.Renderers[x];\n            if (renderer.getIcon && renderer.getIdentifier) {\n                var rendererButton = jQuery('<btn class=\"btn btn-xs btn-default\" ></btn>');\n                rendererButton.attr('data-id', renderer.getIdentifier());\n                rendererButton.on('click', this.pickRenderer.bind(this, renderer));\n                jQuery('<i class=\"fa fa-th\"></i>').addClass(renderer.getIcon()).appendTo(rendererButton);\n                renderersGroup.append(rendererButton);\n                renderers++;\n            }\n        }\n\n        if (renderers > 0){\n            this.builder.buttons.append(document.createTextNode(' '));\n            this.builder.buttons.append(renderersGroup);\n        }\n    }\n\n    pickRenderer(renderer) {\n        localStorage.setItem('psfio-renderer', renderer.getIdentifier()); \n        this.setRenderer(renderer);\n    }\n\n    /**=============================================================================================\n     * API\n     =============================================================================================*/\n\n    goToFolder(folder) {\n        this.loadedDir = folder;\n        this.refresh();\n    }\n\n    refresh() {\n        this.files(this.loadedDir);\n    }\n\n    files(path) {\n        this.request('files', {}, this.onFilesSuccess.bind(this), this.onFilesError.bind(this));\n    }\n\n    onFilesSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onFilesError() {}\n\n    rename(item, newName) {\n        this.request('rename', {file: item, newName: newName}, this.onRenameSuccess.bind(this), this.onRenameError.bind(this));\n    }\n\n    onRenameSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onRenameError() {}\n\n    deleteItem(item) {\n        this.request('delete', {files: item}, this.onDeleteItemSuccess.bind(this), this.onDeleteItemError.bind(this));\n    }\n\n    onDeleteItemSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onDeleteItemError() {}\n\n    newFolder(name) {\n        this.request('newFolder', {folderName: name}, this.onNewFolderSuccess.bind(this), this.onNewFolderError.bind(this));\n    }\n\n    onNewFolderSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onNewFolderError() {}\n\n    uploadFiles(formData) {\n        jQuery.ajax(this.connector+'upload', {\n            type: 'POST',\n            data: formData,\n            dataType: 'json',\n            success: this.onUploadFilesSuccess.bind(this), \n            error: this.onUploadFilesError.bind(this),\n            processData: false, \n            contentType: false\n        });\n    }\n\n    onUploadFilesSuccess(files) {\n        this.parseFiles(files);\n    }\n\n    onUploadFilesError() {}\n\n    request(action, data, success, error) {\n        data = data || {};\n        data.folder = this.loadedDir;\n\n        jQuery.ajax(this.connector+action, {\n            type: 'GET',\n            data: data,\n            dataType: 'json',\n            success: success, \n            error: error\n        });\n    }\n\n    /**=============================================================================================\n     * Binding\n     =============================================================================================*/\n\n    parseFiles(files) {\n        this.structure = files;\n        this.render();\n    }\n\n    render() {\n        if (!this.structure)\n            return;\n\n        this.clearPane();\n        if (this.loadedDir != '') {\n            var upElement = this.renderer.getUP('UP');\n            var parentFolder = PS.PSFio.PathHelper.getParentFolder(this.loadedDir);\n            upElement.on('dblclick', this.goToFolder.bind(this, parentFolder));\n            this.appendElement(upElement);\n        }\n        \n        //List Folders\n        for (var i=0; i<this.structure.folders.length; i++) {\n            var folder = this.structure.folders[i];\n            var folderElement = this.renderer.getFolder(folder, this.loadedDir);\n            this.consumeFolderElement(folderElement, folder);\n        }\n\n        //List Files\n        for (var i=0; i<this.structure.files.length; i++) {\n            var file = this.structure.files[i];\n            var fileElement = this.renderer.getFile(file, this.loadedDir);\n            this.consumeFileElement(fileElement, file);\n        }\n    }\n\n    consumeFileElement(fileElement, file) {\n        this.appendElement(fileElement);\n        this.armFileElement(fileElement, file);\n    }\n\n    consumeFolderElement(folderElement, folder, isBack) {\n        this.appendElement(folderElement);\n        this.armFolderElement(folderElement, folder);\n    }\n\n    appendElement(element) {\n        this.fileList.append(element);\n    }\n\n    clearPane() {\n        this.renderer.clear(this.fileList);\n    }\n\n    armFileElement(fileElement, file) {\n        this.armMutual(fileElement, file);\n        fileElement.on('dblclick', this.pickFile.bind(this, file));\n    }\n\n    armFolderElement(folderElement, folder) {\n        this.armMutual(folderElement, folder);\n        folderElement.on('dblclick', this.goToItem.bind(this, folder));\n    }\n\n    armMutual(itemElement, item) {\n        itemElement.find('.psfio-remove').on('click', this.deleteItemConfirm.bind(this, item));\n        itemElement.find('.psfio-rename').on('click', this.renameItemPrompt.bind(this, item));\n    }\n\n    pickFile(file) {\n        //@TODO should be sanitized when sanitization function is created and this condition should be removed this.loadedDir ? : ...\n        if (this.callback)\n            this.callback([this.loadedDir ? this.loadedDir+'/'+file : file]);\n\n        if (this.destroyOnPick)\n            this.destroy();\n        else if (!this.inline)\n            this.hide();\n    }\n\n    goToItem(item) {\n        this.goToFolder(item);\n    }\n\n    renameItemPrompt(item) {\n        var newName = prompt('Rename file', item);\n        if (newName)\n            this.rename(item, newName)\n    }\n\n    deleteItemConfirm(item) {\n        var isConfirmed = confirm('Are you sure you want to delete this file');\n        if (isConfirmed)\n            this.deleteItem([item]);\n    }\n\n    /**=============================================================================================\n     * Binding\n     =============================================================================================*/\n\n    reset() {\n        this.clearPane();\n        this.goToFolder('');\n    }\n\n    //Facaded for easier access\n    hide() {\n        if (this.builder)\n            this.builder.hide();\n    }\n\n    //Facaded for easier access\n    show() {\n        if (this.builder)\n            this.builder.show();\n    }\n\n    destroy() {\n        this.hide();\n\n        this.builder.clean();\n        this.builder = null;\n\n        this.renderer.clean();\n        this.renderer = null;\n\n        this.structure = null;\n    }\n\n    static getShared() {\n        if (!this.sharedInstance)\n            this.sharedInstance = new this({show: false});\n\n        return this.sharedInstance;\n    }\n\n    static getAssetPath(path) {\n        if (!this.root) {\n            var root = $('meta[name=\"psfio-root\"]').attr('content');\n            this.root = root ? root : '/files';\n        }\n\n        //@TODO Should be sanitized upon concatenation\n        return this.root + '/' + path;\n    }\n}","PS.PSFio.Builders = {};","PS.PSFio.FileHelper = {\n    getFaIconForFile: function(file) {\n        var extension = PS.PSFio.PathHelper.getFileParts(file).extension;\n        extension = extension.toLowerCase();\n        switch (extension) {\n            case 'jpg': \n            case 'png': \n            case 'gif':\n            case 'jpeg': \n                return true;\n            case 'xls':\n            case 'xlsx':\n                return 'fa-file-excel-o';\n            case 'pdf':\n                return 'fa-file-pdf-o';\n            case 'doc':\n            case 'docx':\n            case 'rtf':\n            case 'txt':\n                return 'fa-file-word-o';\n            case 'zip':\n            case 'bz':\n            case 'gz':\n            case 'tar':\n                return 'fa-file-zip-o';\n            case 'mpeg4':\n            case 'mov':\n            case 'mp4':\n                return 'fa-file-movie-o';\n            case 'mp3':\n            case 'aiff':\n                return 'fa-file-audio-o';\n            case 'html':\n            case 'css':\n            case 'less':\n            case 'sass':\n            case 'js':\n            case 'php':\n                return 'fa-file-code-o';\n            default: \n                return 'fa-file-o';\n        }\n    }\n}","PS.PSFio.PathHelper = {\n    \n    getParentFolder: function(path) {\n        if (!path)\n            return '';\n\n        if (path.substr(-1) == '/')\n            path = path.substr(0, path.length-1);\n\n        var parts = path.split('/');\n        parts.pop();\n        return parts.join('/');\n    },\n\n    getFileParts: function(path) {\n        var extension = '';\n        var name = '';\n\n        if (path) {\n            var parts = path.split('/');\n            var fileName = parts.pop();\n\n            var fileParts = fileName.split('.');\n            extension = fileParts.pop();\n            name = fileParts.join('.');\n        }\n\n        return {\n            extension: extension, \n            name: name\n        }\n    }\n\n}","PS.PSFio.Renderers = {};","PS.PSFio.Widgets = {};","PS.PSFio.Builders.Inline = class {\n    \n    constructor(opts) {\n        opts = opts || {};\n        this.buttons = opts.appendButtonsTo;\n        this.appendTo = jQuery(opts.appendTo);\n        console.log(opts);\n        this.build();\n    }\n\n    build() {\n        console.log(this.appendTo);\n        this.element = jQuery('<div class=\"psfio psfio-inline\"></div>').appendTo(this.appendTo);\n        \n        if (!this.buttons) \n            this.buttons = jQuery('<div class=\"psfio-buttons\"></div>').appendTo(this.element);\n\n        this.pane = jQuery('<div class=\"psfio-pane\"></div>').appendTo(this.element);\n    }\n\n    clean() {\n        this.element.remove();\n    }\n\n}","PS.PSFio.Builders.Popup = class {\n    \n    constructor(opts) {\n        opts = opts || {};\n        this.appendTo = opts.appendTo ? jQuery(opts.appendTo) : 'body';\n        this.closeOnEscape = opts.closeOnEscape !== false;\n        this.shouldShow = opts.show !== false;\n        this.build(opts);\n    }\n    \n    build() {\n        \n        var html = \n        '<div class=\"modal fade psfio\" tabindex=\"-1\" role=\"dialog\">' +\n            '<div class=\"modal-dialog modal-lg\" role=\"document\">' +\n                '<div class=\"modal-content\">' +\n                    '<div class=\"modal-header\">' +\n                        '<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\n                        '<div class=\"psfio-buttons\"></div>' +\n                    '</div>' +\n                    '<div class=\"modal-body\"><div class=\"psfio-pane\"></div></div>' +\n                    // '<div class=\"modal-footer\"></div>' +\n                '</div>' + \n            '</div>' +\n        '</div>';\n        var modal =  jQuery(html);\n\n        modal.find('.modal-dialog').css('height', '85%');\n        modal.find('.modal-content').css('height', '100%');\n\n        modal.appendTo(this.appendTo);\n        modal.modal({\n            keyboard: this.closeOnEscape,\n            show: this.shouldShow\n        });\n        this.modal = modal;\n        this.buttons = modal.find('.psfio-buttons');\n        this.pane = modal.find('.psfio-pane');\n    }\n\n    clean() {\n        this.modal.remove();\n        this.buttons = null;\n        this.pane = null;\n        this.appendTo = null;\n    }\n\n    show() {\n        this.modal.modal('show');\n    }\n\n    hide() {\n        this.modal.modal('hide')\n    }\n\n}","PS.PSFio.Renderers.Grid = {\n    getFile: function(file, path) {\n        var parts = this.getMutual(file);\n        parts.element.addClass('ps-fio-grid-item-folder');\n        var icon = PS.PSFio.FileHelper.getFaIconForFile(file);\n        if (icon === true)\n            parts.image.css('background-image', 'url(\"'+PS.PSFio.getAssetPath(path+'/'+file)+'\")');\n        else \n            jQuery('<i class=\"fa\"></i>').addClass(icon).appendTo(parts.image);\n        return parts.element;\n    },\n\n    getFolder: function(folder) {\n        var parts = this.getMutual(folder);\n        parts.element.addClass('ps-fio-grid-item-folder');\n        parts.image.append('<i class=\"fa fa-folder\"></i>');\n        return parts.element;\n    },\n\n    getUP: function(text) {\n        var parts = this.getCol();\n        parts.name.text(text);\n        parts.element.addClass('ps-fio-grid-item-back');\n        parts.image.append('<i class=\"fa fa-level-up\"></i>');\n        return parts.element;\n    },\n\n    getMutual: function(item) {\n        var parts = this.getCol();\n        var remove = jQuery('<a href=\"javascript:;\" class=\"btn btn-xs btn-danger psfio-remove\"><i class=\"fa fa-trash\"></i></a>');\n        var rename = jQuery('<a href=\"javascript:;\" class=\"btn btn-xs btn-default psfio-rename\"><i class=\"fa fa-edit\"></i></a>');\n        parts.btnGroup.append(rename).append(remove);\n        parts.name.text(item);\n        return parts;\n    },\n\n    getCol: function() {\n        var element = jQuery('<div class=\"psfio-grid-item\"></div>');\n        var inner = jQuery('<div class=\"psfio-grid-item-inner\"></div>');\n        var name = jQuery('<p class=\"psfio-name\"></p>');\n        var imageSizer = jQuery('<div class=\"psfio-grid-item-image-sizer\"></div>');\n        var image = jQuery('<div class=\"psfio-grid-item-image\"></div>');\n        var btnGroup = jQuery('<div class=\"btn-group\"></div>');\n\n        element.append(inner);\n        inner.append(imageSizer).append(name);\n        imageSizer.append(image);\n        inner.append(btnGroup);\n\n        return {\n            element: element,\n            name: name,\n            inner: inner,\n            image: image,\n            btnGroup: btnGroup\n        }\n    },\n\n    prepare: function(pane) {\n        var list = jQuery('<div class=\"psfio-grid-list\"></div>');\n        pane.append(list);\n        list.on('mousedown', function(e) {e.preventDefault()});\n        return list;\n    },\n\n    clear: function(fileList) {\n        fileList.empty();\n    },\n\n    getIcon: function() {\n        return 'fa-th';\n    },\n\n    getIdentifier: function() {\n        return 'Grid';\n    }\n}","PS.PSFio.Renderers.Table = {\n    getFile: function(file, path) {\n        var parts = this.getMutual(file, path);\n        parts.element.addClass('ps-fio-table-item-folder');\n        var icon = PS.PSFio.FileHelper.getFaIconForFile(file);\n        if (icon === true)\n            jQuery('<img class=\"img-responsive\" />').attr('src', PS.PSFio.getAssetPath(path+'/'+file)).appendTo(parts.icon);\n        else \n            jQuery('<i class=\"fa\"></i>').addClass(icon).appendTo(parts.icon);\n        return parts.element;\n    },\n\n    getFolder: function(folder) {\n        var parts = this.getMutual(folder);\n        parts.element.addClass('ps-fio-table-item-folder');\n        parts.icon.append('<i class=\"fa fa-folder\"></i>');\n        return parts.element;\n    },\n\n    getUP: function(text) {\n        var parts = this.getRow();\n        parts.name.text(text);\n        parts.element.addClass('active ps-fio-table-item-back');\n        parts.icon.append('<i class=\"fa fa-level-up\"></i>');\n        return parts.element;\n    },\n\n    getMutual: function(item) {\n        var parts = this.getRow();\n        var remove = jQuery('<a href=\"javascript:;\" class=\"btn btn-xs btn-danger psfio-remove\"><i class=\"fa fa-trash\"></i></a>');\n        var rename = jQuery('<a href=\"javascript:;\" class=\"btn btn-xs btn-default psfio-rename\"><i class=\"fa fa-edit\"></i></a>');\n        parts.btnGroup.append(rename).append(remove);\n        parts.name.text(item);\n        return parts;\n    },\n\n    getRow: function() {\n        var element = jQuery('<tr></tr>');\n        var btnGroup = jQuery('<div class=\"btn-group\"></div>');\n\n        return {\n            element: element,\n            btnGroup: btnGroup,\n            icon: jQuery('<td></td>').appendTo(element),\n            name: jQuery('<td class=\"col-xs-6\"></td>').appendTo(element),\n            size: jQuery('<td class=\"col-xs-1\"></td>').appendTo(element),\n            dateCreated: jQuery('<td class=\"col-xs-2\"></td>').appendTo(element),\n            dateModified: jQuery('<td class=\"col-xs-2\"></td>').appendTo(element),\n            actions: jQuery('<td class=\"col-xs-1\"></td>').appendTo(element).append(btnGroup)\n        }\n    },\n\n    prepare: function(pane) {\n        var table = jQuery('<table class=\"table table-hover table-condensed\"></table>');\n        var thead = jQuery('<thead></thead>');\n        var tbody = jQuery('<tbody></tbody>');\n        var thRow = jQuery('<tr></tr>');\n\n        this.createHeadColumn(thRow, '');\n        this.createHeadColumn(thRow, 'Name');\n        this.createHeadColumn(thRow, 'Size');\n        this.createHeadColumn(thRow, 'Date created');\n        this.createHeadColumn(thRow, 'Date updated');\n        this.createHeadColumn(thRow, 'Actions');\n\n        thead.append(thRow);\n        table.append(thead).append(tbody);\n        \n        pane.append(table);\n        table.on('mousedown', function(e) {e.preventDefault()});\n        return tbody;\n    },\n\n    createHeadColumn: function(row, name) {\n        jQuery('<th></th>').text(name).appendTo(row);\n    },\n\n    clear: function(fileList) {\n        fileList.empty();\n    },\n\n    getIcon: function() {\n        return 'fa-th-list';\n    },\n\n    getIdentifier: function() {\n        return 'Table';\n    }\n}","$(document).ready(function() {\n    var browsers = jQuery('*[data-psfio=\"browse\"]');\n    for (var i=0; i<browsers.length; i++) {\n        browsers.eq(i).on('click', function() {\n            PS.PSFio.getShared().show();\n        });\n    }\n});","(function($, name) {\n\n    $.fn[name] = function( methodOrOptions ) {\n\n        var me = $(this);\n\n        if (!me.length) \n            return me;\n\n        var firstMe = $(this).eq(0);\n        \n        var instance = firstMe.data(name);\n            \n        // CASE: call method     \n        if (instance && instance[ methodOrOptions ] && \n            typeof( instance[ methodOrOptions ] ) == 'function' ) {\n            \n            return instance[ methodOrOptions ]( Array.prototype.slice.call( arguments, 1 ) ); \n                \n                \n        // CASE: set options or initialize\n        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {\n\n            methodOrOptions = methodOrOptions || {};\n            methodOrOptions.inline = true;\n            methodOrOptions.appendTo = firstMe;\n            instance = new PS.PSFio( methodOrOptions );    // ok to overwrite if this is a re-init\n            firstMe.data(name, instance);\n            return me;\n        \n        // CASE: method called before init\n        } else if ( !instance ) {\n            $.error( 'Instance not created yet: ' + methodOrOptions );\n        \n        // CASE: invalid method\n        } else {\n            $.error( 'Method ' +  methodOrOptions + ' does not exist.' );\n        }\n    };\n\n    $(document).ready(function() {\n        var browsers = jQuery('*[data-psfio=\"file-browser\"]');\n        for (var i=0; i<browsers.length; i++)\n            browsers.eq(i)[name]();\n    });\n\n})(jQuery, 'PSFioFileBrowser');","(function($, name) {\n\n    $.fn[name] = function( methodOrOptions ) {\n        var me = $(this);\n        if (!me.length) \n            return me;\n\n        var firstMe = me.eq(0);\n        \n        var instance = firstMe.data(name);\n            \n        // CASE: call method     \n        if (instance && instance[ methodOrOptions ] && \n            typeof( instance[ methodOrOptions ] ) == 'function' ) {\n            \n            return instance[ methodOrOptions ]( Array.prototype.slice.call( arguments, 1 ) ); \n                \n                \n        // CASE: set options or initialize\n        } else if ( typeof methodOrOptions === 'object' || ! methodOrOptions ) {\n\n            instance = new PS.PSFio.Widgets.Image( firstMe, methodOrOptions );    // ok to overwrite if this is a re-init\n            firstMe.data(name, instance);\n            return me;\n        \n        // CASE: method called before init\n        } else if ( !instance ) {\n            $.error( 'Instance not created yet: ' + methodOrOptions );\n        \n        // CASE: invalid method\n        } else {\n            $.error( 'Method ' +  methodOrOptions + ' does not exist.' );\n        }\n    };\n\n    $(document).ready(function() {\n        var inputs = $('input[data-psfio=\"image\"]');\n        for (var i=0; i<inputs.length; i++)\n            inputs.eq(i)[name]();\n    });\n\n})(jQuery, 'PSFioImage');","PS.PSFio.Widgets.Image = class {\n    \n    constructor(file, opts) {\n        this.input = file;\n        this.build(file);\n        this.displayFile(file.val());\n    }\n\n    build(file) {\n        var wrapper = jQuery('<div class=\"psfio-image-widget\"></div>').insertAfter(file);\n        var formGroup = jQuery('<div class=\"form-group\"></div>').appendTo(wrapper);\n        this.noImage = jQuery('<div>No image selected</div>').appendTo(formGroup);\n        this.image = jQuery('<img class=\"img-responsive\" />').appendTo(formGroup);\n\n        var buttonGroup = jQuery('<div class=\"btn-group\">').appendTo(wrapper);\n        var browse = jQuery('<button type=\"button\" class=\"btn btn-xs btn-default\"><i class=\"fa fa-folder\"></i> Browse</button>').appendTo(buttonGroup);\n        var clear = jQuery('<button type=\"button\" class=\"btn btn-xs btn-danger\"><i class=\"fa fa-remove\"></i> Remove</button>').appendTo(buttonGroup);\n\n        browse.on('click', this.browse.bind(this));\n        clear.on('click', this.clear.bind(this));\n        file.detach().appendTo(wrapper);\n    }\n\n    browse() {\n        var fio = PS.PSFio.getShared();\n        fio.setCallback(this.onPick.bind(this));\n        fio.show();\n    }\n\n    onPick(files) {\n        if (files.length > 0)\n            this.displayFile(files[0]);\n        \n    }\n\n    displayFile(file) {\n        if (file == '')\n            this.clear();\n        else {\n            this.input.val(file);\n            this.image.show().attr('src', PS.PSFio.getAssetPath(file));\n            this.noImage.hide();\n        }\n        \n    }\n\n    clear() {\n        this.input.val('');\n        this.image.hide();\n        this.noImage.show();\n    }\n\n}"]}